<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Event Engagement Booster</title>

    <style media="screen">
      body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: #f4f7f6; color: #333; margin: 0; padding: 2rem; }
      .container { max-width: 800px; margin: auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
      h1, h2 { color: #2c3e50; border-bottom: 2px solid #e0e0e0; padding-bottom: 10px; }
      form { display: flex; flex-direction: column; gap: 1rem; }
      input, textarea { padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; }
      button { padding: 12px; background-color: #3498db; color: white; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; transition: background-color 0.3s; }
      button:hover { background-color: #2980b9; }
      .form-section { margin-bottom: 2rem; }
      #status { margin-top: 1.5rem; padding: 1rem; border-radius: 4px; text-align: center; font-weight: bold; display: none; }
      .success { background-color: #d4edda; color: #155724; }
      .error { background-color: #f8d7da; color: #721c24; }
      @media (max-width: 600px) {
        body, #message { margin-top: 0; background: white; box-shadow: none; }
        body { border-top: 16px solid #ffa100; }
      }
    </style>
  </head>
  <body>

<div class="container">
    <h1>Event & Webinar Engagement Booster</h1>

    <div class="form-section">
        <h2>Step 1: Create an Event</h2>
        <form id="event-form">
            <input type="text" id="event-name" placeholder="Event Name" required>
            <textarea id="event-description" placeholder="Event Description" required></textarea>
            <input type="datetime-local" id="event-time" required>
            <button type="submit">Create Event</button>
        </form>
    </div>

    <div class="form-section">
        <h2>Step 2: Register a User</h2>
        <form id="register-form">
            <input type="number" id="register-event-id" placeholder="Event ID (from Step 1)" required>
            <input type="text" id="user-name" placeholder="User's Name" required>
            <input type="email" id="user-email" placeholder="User's Email" required>
            <input type="text" id="user-interests" placeholder="User's Interests (e.g., AI, Python)">
            <button type="submit">Register User & Start AI Agent</button>
        </form>
    </div>

    <div id="status"></div>
</div>

    <script>
        const API_BASE_URL = "http://127.0.0.1:8000"; // Your Python backend URL
        const eventForm = document.getElementById('event-form');
        const registerForm = document.getElementById('register-form');
        const statusDiv = document.getElementById('status');

        function showStatus(message, isError = false) {
            statusDiv.textContent = message;
            statusDiv.className = isError ? 'error' : 'success';
            statusDiv.style.display = 'block';
            setTimeout(() => { statusDiv.style.display = 'none'; }, 5000);
        }

        eventForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const eventName = document.getElementById('event-name').value;
            const eventDescription = document.getElementById('event-description').value;
            const eventTime = new Date(document.getElementById('event-time').value).toISOString();

            try {
                const response = await fetch(`${API_BASE_URL}/events/`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: eventName,
                        description: eventDescription,
                        event_time: eventTime
                    })
                });

                if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                const result = await response.json();
                showStatus(`Event "${result.name}" created successfully! You can now register users for it.`);
                eventForm.reset();
            } catch (error) {
                showStatus(`Error creating event: ${error.message}`, true);
            }
        });

        registerForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const eventId = parseInt(document.getElementById('register-event-id').value);
            const userName = document.getElementById('user-name').value;
            const userEmail = document.getElementById('user-email').value;
            const userInterests = document.getElementById('user-interests').value;

            try {
                const response = await fetch(`${API_BASE_URL}/register/`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        user: { name: userName, email: userEmail, interests: userInterests },
                        event_id: eventId
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || `HTTP error! Status: ${response.status}`);
                }
                const result = await response.json();
                showStatus(result.message);
                registerForm.reset();
            } catch (error) {
                showStatus(`Error registering user: ${error.message}`, true);
            }
        });
    </script>

  </body>
</html>
